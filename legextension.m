function legextension  % Model of leg extension with muscle force-length curve  % and no tendon elasticity.	  % Lower leg parameters	I = 0.1832;   % moment of inertia of lower leg (kg-m^2)	m = 4.88;     % mass (kg)	g = 9.81;     % grav constant	  % Muscle parameters	lopt = 0.09;  % optimal muscle length in meters	Fmax = 6000;  % max isometric force (N)	rf   = 0.033; % moment arm of quadriceps muscle	rcm  = 0.264; % distance b/w center of mass & joint	phi0 = 1.5*pi/2;  % estimated leg angle for optimal fiber length	a = 1;   % maximum activation level		phis = pi:-0.1:pi/2;  % Try these joint angles		for i = 1:length(phis)		phi = phis(i);		l = rf*(1.5*pi/2 - phi) / lopt + 1;  % calculate the normalized muscle length		F = Fmax * (fl(l) * a + flp(l));     % calculate the actual muscle force		M = F * rf - m * g * rcm * sin(phi - pi/2);   % available moment		Ms(i) = M;	end;	    % plot maximum isometric knee moment vs knee angle	plot(phis*180/pi,Ms)	xlabel('Knee angle (deg)')	ylabel('Maximum external moment (N-m)')    pause;    % Plot force-length curves    x = 0.5:0.1:1.5; % normalized muscle fiber lengths    %% ADD some code here to make some plotsend % leg extensionfunction f = fl(x)  % normalized force-length curve, where input is muscle fiber length,  % itself normalized with respect to optimal fiber length, so that  % a value of x = 1 corresponds to the peak in the force-length curve.  % The force-length curve is modeled as a simple parabolic  	w = 0.5; % this sets the width of the parabolic	lopt = 1;  % this is a normalized optimal length, which the parabola             % is centered around.		f = 1 - ((x-lopt)/(w*lopt)).^2;  % a piece of a parabolic curve  % rectify the force, eliminating negative values	f(f<0) = 0;           % this is a fancy statement that lets you assign 	                      % only those values than zero to zeroend % flfunction f = flp(x)  % normalized passive force-length curve for muscle, where  % input x is fiber length, normalized to optimal fiber length,  % and starting at 1 = 100% optimal fiber length.  % So 1.1 = 110%, or 10% strain beyond optimal.  % The curve here is modeled as a cubic; also can be modeled as an  % exponential.	    f = 8*(x-1).^3; % Subtract 1 to calculate strain from peak isometric	  % rectify the passive force-length curve	f(x < 1) = 0;end % flp